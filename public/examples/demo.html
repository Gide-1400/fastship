<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FastShip - ูุซุงู ุชุฌุฑูุจู ููููุทู ุงูุฃุณุงุณู</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- FastShip Core -->
    <script src="../core/models.js"></script>
    <script src="../core/matching-engine.js"></script>
    <script src="../core/pricing-engine.js"></script>
    <script src="../core/trip-manager.js"></script>
    <script src="../core/mock-data.js"></script>
    <script src="../core/fastship-core.js"></script>
    
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
        }
        .demo-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .output {
            background: #f3f4f6;
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: monospace;
            direction: ltr;
            text-align: left;
            max-height: 400px;
            overflow-y: auto;
        }
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-primary {
            background: #3b82f6;
            color: white;
        }
        .btn-primary:hover {
            background: #2563eb;
        }
    </style>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-6xl mx-auto">
        <h1 class="text-4xl font-bold text-gray-800 mb-8">๐ FastShip - ูุซุงู ุชุฌุฑูุจู</h1>
        
        <!-- ุฅุญุตุงุฆูุงุช ุงูููุตุฉ -->
        <div class="demo-section">
            <h2 class="text-2xl font-bold mb-4">๐ ุฅุญุตุงุฆูุงุช ุงูููุตุฉ</h2>
            <button onclick="showStatistics()" class="btn btn-primary">ุนุฑุถ ุงูุฅุญุตุงุฆูุงุช</button>
            <div id="stats-output" class="output mt-4" style="display: none;"></div>
        </div>
        
        <!-- ุฅูุดุงุก ุดุญูุฉ -->
        <div class="demo-section">
            <h2 class="text-2xl font-bold mb-4">๐ฆ ุฅูุดุงุก ุดุญูุฉ ุฌุฏูุฏุฉ</h2>
            <div class="grid grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block mb-2">ุงููุฆุฉ:</label>
                    <select id="category" class="w-full p-2 border rounded">
                        <option value="electronics">ุฅููุชุฑูููุงุช</option>
                        <option value="documents">ูุณุชูุฏุงุช</option>
                        <option value="clothes">ููุงุจุณ</option>
                        <option value="food">ุฃุทุนูุฉ</option>
                    </select>
                </div>
                <div>
                    <label class="block mb-2">ุงููุฒู (ูุฌู):</label>
                    <input type="number" id="weight" value="5" class="w-full p-2 border rounded">
                </div>
                <div>
                    <label class="block mb-2">ูู:</label>
                    <select id="fromCity" class="w-full p-2 border rounded">
                        <option value="ุงูุฑูุงุถ">ุงูุฑูุงุถ</option>
                        <option value="ุฌุฏุฉ">ุฌุฏุฉ</option>
                        <option value="ุงูุฏูุงู">ุงูุฏูุงู</option>
                        <option value="ุงููุฏููุฉ ุงููููุฑุฉ">ุงููุฏููุฉ ุงููููุฑุฉ</option>
                    </select>
                </div>
                <div>
                    <label class="block mb-2">ุฅูู:</label>
                    <select id="toCity" class="w-full p-2 border rounded">
                        <option value="ุฌุฏุฉ">ุฌุฏุฉ</option>
                        <option value="ุงูุฑูุงุถ">ุงูุฑูุงุถ</option>
                        <option value="ุงูุฏูุงู">ุงูุฏูุงู</option>
                        <option value="ุงููุฏููุฉ ุงููููุฑุฉ">ุงููุฏููุฉ ุงููููุฑุฉ</option>
                    </select>
                </div>
            </div>
            <button onclick="createShipment()" class="btn btn-primary">ุฅูุดุงุก ุงูุดุญูุฉ</button>
            <div id="shipment-output" class="output mt-4" style="display: none;"></div>
        </div>
        
        <!-- ุงูุจุญุซ ุนู ููุตููู -->
        <div class="demo-section">
            <h2 class="text-2xl font-bold mb-4">๐ ุงูุจุญุซ ุนู ููุตููู</h2>
            <button onclick="findCarriers()" class="btn btn-primary">ุจุญุซ ุนู ููุตููู</button>
            <div id="carriers-output" class="output mt-4" style="display: none;"></div>
        </div>
        
        <!-- ุญุณุงุจ ุงูุณุนุฑ -->
        <div class="demo-section">
            <h2 class="text-2xl font-bold mb-4">๐ฐ ุญุณุงุจ ุงูุณุนุฑ</h2>
            <button onclick="calculatePrice()" class="btn btn-primary">ุญุณุงุจ ุงูุณุนุฑ</button>
            <div id="price-output" class="output mt-4" style="display: none;"></div>
        </div>
        
        <!-- ุงูุจุญุซ ุนู ุฑุญูุงุช -->
        <div class="demo-section">
            <h2 class="text-2xl font-bold mb-4">๐ฃ๏ธ ุงูุจุญุซ ุนู ุฑุญูุงุช ูุชุงุญุฉ</h2>
            <button onclick="findTrips()" class="btn btn-primary">ุจุญุซ ุนู ุฑุญูุงุช</button>
            <div id="trips-output" class="output mt-4" style="display: none;"></div>
        </div>
        
        <!-- ุชุญุณูู ุงููุณุงุญุฉ -->
        <div class="demo-section">
            <h2 class="text-2xl font-bold mb-4">๐ฏ ุชุญุณูู ุงุณุชุบูุงู ุงููุณุงุญุฉ</h2>
            <button onclick="optimizeSpace()" class="btn btn-primary">ุชุญุณูู ุงููุณุงุญุฉ</button>
            <div id="optimize-output" class="output mt-4" style="display: none;"></div>
        </div>
    </div>
    
    <script>
        let lastShipmentId = null;
        
        // ุงูุชุธุงุฑ ุฌุงูุฒูุฉ ุงูููุตุฉ
        window.addEventListener('fastship:ready', function() {
            console.log('โ FastShip ready!');
        });
        
        // ุนุฑุถ ุงูุฅุญุตุงุฆูุงุช
        function showStatistics() {
            const stats = window.FastShip.getStatistics();
            const output = document.getElementById('stats-output');
            output.style.display = 'block';
            output.innerHTML = JSON.stringify(stats, null, 2);
        }
        
        // ุฅูุดุงุก ุดุญูุฉ
        function createShipment() {
            const category = document.getElementById('category').value;
            const weight = parseFloat(document.getElementById('weight').value);
            const fromCity = document.getElementById('fromCity').value;
            const toCity = document.getElementById('toCity').value;
            
            // ุงูุญุตูู ุนูู ุจูุงูุงุช ุงููุฏู
            const cities = window.FastShipMockData.saudiCities;
            const fromCityData = cities.find(c => c.city === fromCity);
            const toCityData = cities.find(c => c.city === toCity);
            
            const shipment = window.FastShip.createShipment({
                senderId: 'USR-DEMO',
                category,
                weight,
                dimensions: { length: 30, width: 20, height: 10 },
                fromLocation: new window.FastShipModels.Location(fromCityData),
                toLocation: new window.FastShipModels.Location(toCityData),
                pickupDate: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(),
                description: 'ุดุญูุฉ ุชุฌุฑูุจูุฉ',
                value: 1000,
                insuranceRequired: true
            });
            
            lastShipmentId = shipment.id;
            
            const output = document.getElementById('shipment-output');
            output.style.display = 'block';
            output.innerHTML = JSON.stringify({
                id: shipment.id,
                type: shipment.type,
                weight: shipment.weight,
                from: fromCity,
                to: toCity,
                status: shipment.status
            }, null, 2);
        }
        
        // ุงูุจุญุซ ุนู ููุตููู
        function findCarriers() {
            if (!lastShipmentId) {
                alert('ูุฑุฌู ุฅูุดุงุก ุดุญูุฉ ุฃููุงู');
                return;
            }
            
            const matches = window.FastShip.findCarriersForShipment(lastShipmentId, {
                minRating: 4.0,
                verifiedOnly: true
            });
            
            const output = document.getElementById('carriers-output');
            output.style.display = 'block';
            output.innerHTML = JSON.stringify(matches.map(m => ({
                carrier: {
                    id: m.carrier.id,
                    type: m.carrier.type,
                    rating: m.carrier.rating,
                    availableSpace: m.carrier.availableSpace
                },
                score: m.score,
                tripsCount: m.trips.length
            })), null, 2);
        }
        
        // ุญุณุงุจ ุงูุณุนุฑ
        function calculatePrice() {
            if (!lastShipmentId) {
                alert('ูุฑุฌู ุฅูุดุงุก ุดุญูุฉ ุฃููุงู');
                return;
            }
            
            const matches = window.FastShip.findCarriersForShipment(lastShipmentId);
            
            if (matches.length === 0) {
                alert('ูุง ููุฌุฏ ููุตููู ูุชุงุญูู');
                return;
            }
            
            const pricing = window.FastShip.calculateShipmentPrice(
                lastShipmentId,
                matches[0].carrier.id,
                {
                    urgency: 'nextDay',
                    includeInsurance: true
                }
            );
            
            const output = document.getElementById('price-output');
            output.style.display = 'block';
            output.innerHTML = JSON.stringify({
                basePrice: pricing.basePrice + ' ุฑูุงู',
                additionalFees: pricing.additionalFees + ' ุฑูุงู',
                insurance: pricing.insuranceCost + ' ุฑูุงู',
                tax: pricing.taxAmount + ' ุฑูุงู',
                totalPrice: pricing.totalPrice + ' ุฑูุงู',
                carrierEarnings: pricing.carrierEarnings + ' ุฑูุงู',
                platformCommission: pricing.platformCommission + ' ุฑูุงู'
            }, null, 2);
        }
        
        // ุงูุจุญุซ ุนู ุฑุญูุงุช
        function findTrips() {
            if (!lastShipmentId) {
                alert('ูุฑุฌู ุฅูุดุงุก ุดุญูุฉ ุฃููุงู');
                return;
            }
            
            const trips = window.FastShip.findTripsForShipment(lastShipmentId);
            
            const output = document.getElementById('trips-output');
            output.style.display = 'block';
            output.innerHTML = JSON.stringify(trips.map(t => ({
                tripId: t.trip.id,
                carrierId: t.trip.carrierId,
                price: t.price + ' ุฑูุงู',
                distance: t.distance + ' ูู',
                duration: t.estimatedDuration + ' ุณุงุนุฉ',
                matchScore: t.matchScore
            })), null, 2);
        }
        
        // ุชุญุณูู ุงููุณุงุญุฉ
        function optimizeSpace() {
            const trips = window.FastShipTripManager.getAllTrips();
            
            if (trips.length === 0) {
                alert('ูุง ุชูุฌุฏ ุฑุญูุงุช ูุชุงุญุฉ');
                return;
            }
            
            const optimization = window.FastShip.optimizeTripSpace(trips[0].id);
            
            const output = document.getElementById('optimize-output');
            output.style.display = 'block';
            output.innerHTML = JSON.stringify({
                selectedShipments: optimization.shipments.length,
                totalWeight: optimization.totalWeight + ' ูุฌู',
                utilization: optimization.utilization.toFixed(2) + '%',
                remainingCapacity: optimization.remainingCapacity + ' ูุฌู'
            }, null, 2);
        }
    </script>
</body>
</html>
