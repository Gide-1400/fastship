<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FastShip - Ù…Ø«Ø§Ù„ ØªØ¬Ø±ÙŠØ¨ÙŠ Ù„Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- FastShip Core -->
    <script src="../core/models.js"></script>
    <script src="../core/matching-engine.js"></script>
    <script src="../core/pricing-engine.js"></script>
    <script src="../core/trip-manager.js"></script>
    <script src="../core/mock-data.js"></script>
    <script src="../core/fastship-core.js"></script>
    
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
        }
        .demo-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .output {
            background: #f3f4f6;
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: monospace;
            direction: ltr;
            text-align: left;
            max-height: 400px;
            overflow-y: auto;
        }
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-primary {
            background: #3b82f6;
            color: white;
        }
        .btn-primary:hover {
            background: #2563eb;
        }
    </style>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-6xl mx-auto">
        <h1 class="text-4xl font-bold text-gray-800 mb-8">ğŸš€ FastShip - Ù…Ø«Ø§Ù„ ØªØ¬Ø±ÙŠØ¨ÙŠ</h1>
        
        <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ù†ØµØ© -->
        <div class="demo-section">
            <h2 class="text-2xl font-bold mb-4">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ù†ØµØ©</h2>
            <button onclick="showStatistics()" class="btn btn-primary">Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</button>
            <div id="stats-output" class="output mt-4" style="display: none;"></div>
        </div>
        
        <!-- Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø­Ù†Ø© -->
        <div class="demo-section">
            <h2 class="text-2xl font-bold mb-4">ğŸ“¦ Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø­Ù†Ø© Ø¬Ø¯ÙŠØ¯Ø©</h2>
            <div class="grid grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block mb-2">Ø§Ù„ÙØ¦Ø©:</label>
                    <select id="category" class="w-full p-2 border rounded">
                        <option value="electronics">Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª</option>
                        <option value="documents">Ù…Ø³ØªÙ†Ø¯Ø§Øª</option>
                        <option value="clothes">Ù…Ù„Ø§Ø¨Ø³</option>
                        <option value="food">Ø£Ø·Ø¹Ù…Ø©</option>
                    </select>
                </div>
                <div>
                    <label class="block mb-2">Ø§Ù„ÙˆØ²Ù† (ÙƒØ¬Ù…):</label>
                    <input type="number" id="weight" value="5" class="w-full p-2 border rounded">
                </div>
                <div>
                    <label class="block mb-2">Ù…Ù†:</label>
                    <select id="fromCity" class="w-full p-2 border rounded">
                        <option value="Ø§Ù„Ø±ÙŠØ§Ø¶">Ø§Ù„Ø±ÙŠØ§Ø¶</option>
                        <option value="Ø¬Ø¯Ø©">Ø¬Ø¯Ø©</option>
                        <option value="Ø§Ù„Ø¯Ù…Ø§Ù…">Ø§Ù„Ø¯Ù…Ø§Ù…</option>
                        <option value="Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©</option>
                    </select>
                </div>
                <div>
                    <label class="block mb-2">Ø¥Ù„Ù‰:</label>
                    <select id="toCity" class="w-full p-2 border rounded">
                        <option value="Ø¬Ø¯Ø©">Ø¬Ø¯Ø©</option>
                        <option value="Ø§Ù„Ø±ÙŠØ§Ø¶">Ø§Ù„Ø±ÙŠØ§Ø¶</option>
                        <option value="Ø§Ù„Ø¯Ù…Ø§Ù…">Ø§Ù„Ø¯Ù…Ø§Ù…</option>
                        <option value="Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©</option>
                    </select>
                </div>
            </div>
            <button onclick="createShipment()" class="btn btn-primary">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø´Ø­Ù†Ø©</button>
            <div id="shipment-output" class="output mt-4" style="display: none;"></div>
        </div>
        
        <!-- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…ÙˆØµÙ„ÙŠÙ† -->
        <div class="demo-section">
            <h2 class="text-2xl font-bold mb-4">ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…ÙˆØµÙ„ÙŠÙ†</h2>
            <button onclick="findCarriers()" class="btn btn-primary">Ø¨Ø­Ø« Ø¹Ù† Ù…ÙˆØµÙ„ÙŠÙ†</button>
            <div id="carriers-output" class="output mt-4" style="display: none;"></div>
        </div>
        
        <!-- Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± -->
        <div class="demo-section">
            <h2 class="text-2xl font-bold mb-4">ğŸ’° Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø±</h2>
            <button onclick="calculatePrice()" class="btn btn-primary">Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø±</button>
            <div id="price-output" class="output mt-4" style="display: none;"></div>
        </div>
        
        <!-- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø±Ø­Ù„Ø§Øª -->
        <div class="demo-section">
            <h2 class="text-2xl font-bold mb-4">ğŸ›£ï¸ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø±Ø­Ù„Ø§Øª Ù…ØªØ§Ø­Ø©</h2>
            <button onclick="findTrips()" class="btn btn-primary">Ø¨Ø­Ø« Ø¹Ù† Ø±Ø­Ù„Ø§Øª</button>
            <div id="trips-output" class="output mt-4" style="display: none;"></div>
        </div>
        
        <!-- ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø³Ø§Ø­Ø© -->
        <div class="demo-section">
            <h2 class="text-2xl font-bold mb-4">ğŸ¯ ØªØ­Ø³ÙŠÙ† Ø§Ø³ØªØºÙ„Ø§Ù„ Ø§Ù„Ù…Ø³Ø§Ø­Ø©</h2>
            <button onclick="optimizeSpace()" class="btn btn-primary">ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø³Ø§Ø­Ø©</button>
            <div id="optimize-output" class="output mt-4" style="display: none;"></div>
        </div>
    </div>
    
    <script>
        let lastShipmentId = null;
        
        // Ø§Ù†ØªØ¸Ø§Ø± Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ù…Ù†ØµØ©
        window.addEventListener('fastship:ready', function() {
            console.log('âœ… FastShip ready!');
        });
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function showStatistics() {
            const stats = window.FastShip.getStatistics();
            const output = document.getElementById('stats-output');
            output.style.display = 'block';
            output.innerHTML = JSON.stringify(stats, null, 2);
        }
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø­Ù†Ø©
        function createShipment() {
            const category = document.getElementById('category').value;
            const weight = parseFloat(document.getElementById('weight').value);
            const fromCity = document.getElementById('fromCity').value;
            const toCity = document.getElementById('toCity').value;
            
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯Ù†
            const cities = window.FastShipMockData.saudiCities;
            const fromCityData = cities.find(c => c.city === fromCity);
            const toCityData = cities.find(c => c.city === toCity);
            
            const shipment = window.FastShip.createShipment({
                senderId: 'USR-DEMO',
                category,
                weight,
                dimensions: { length: 30, width: 20, height: 10 },
                fromLocation: new window.FastShipModels.Location(fromCityData),
                toLocation: new window.FastShipModels.Location(toCityData),
                pickupDate: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(),
                description: 'Ø´Ø­Ù†Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©',
                value: 1000,
                insuranceRequired: true
            });
            
            lastShipmentId = shipment.id;
            
            const output = document.getElementById('shipment-output');
            output.style.display = 'block';
            output.innerHTML = JSON.stringify({
                id: shipment.id,
                type: shipment.type,
                weight: shipment.weight,
                from: fromCity,
                to: toCity,
                status: shipment.status
            }, null, 2);
        }
        
        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…ÙˆØµÙ„ÙŠÙ†
        function findCarriers() {
            if (!lastShipmentId) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø­Ù†Ø© Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            const matches = window.FastShip.findCarriersForShipment(lastShipmentId, {
                minRating: 4.0,
                verifiedOnly: true
            });
            
            const output = document.getElementById('carriers-output');
            output.style.display = 'block';
            output.innerHTML = JSON.stringify(matches.map(m => ({
                carrier: {
                    id: m.carrier.id,
                    type: m.carrier.type,
                    rating: m.carrier.rating,
                    availableSpace: m.carrier.availableSpace
                },
                score: m.score,
                tripsCount: m.trips.length
            })), null, 2);
        }
        
        // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø±
        function calculatePrice() {
            if (!lastShipmentId) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø­Ù†Ø© Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            const matches = window.FastShip.findCarriersForShipment(lastShipmentId);
            
            if (matches.length === 0) {
                alert('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙˆØµÙ„ÙŠÙ† Ù…ØªØ§Ø­ÙŠÙ†');
                return;
            }
            
            const pricing = window.FastShip.calculateShipmentPrice(
                lastShipmentId,
                matches[0].carrier.id,
                {
                    urgency: 'nextDay',
                    includeInsurance: true
                }
            );
            
            const output = document.getElementById('price-output');
            output.style.display = 'block';
            output.innerHTML = JSON.stringify({
                basePrice: pricing.basePrice + ' Ø±ÙŠØ§Ù„',
                additionalFees: pricing.additionalFees + ' Ø±ÙŠØ§Ù„',
                insurance: pricing.insuranceCost + ' Ø±ÙŠØ§Ù„',
                tax: pricing.taxAmount + ' Ø±ÙŠØ§Ù„',
                totalPrice: pricing.totalPrice + ' Ø±ÙŠØ§Ù„',
                carrierEarnings: pricing.carrierEarnings + ' Ø±ÙŠØ§Ù„',
                platformCommission: pricing.platformCommission + ' Ø±ÙŠØ§Ù„'
            }, null, 2);
        }
        
        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø±Ø­Ù„Ø§Øª
        function findTrips() {
            if (!lastShipmentId) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø­Ù†Ø© Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            const trips = window.FastShip.findTripsForShipment(lastShipmentId);
            
            const output = document.getElementById('trips-output');
            output.style.display = 'block';
            output.innerHTML = JSON.stringify(trips.map(t => ({
                tripId: t.trip.id,
                carrierId: t.trip.carrierId,
                price: t.price + ' Ø±ÙŠØ§Ù„',
                distance: t.distance + ' ÙƒÙ…',
                duration: t.estimatedDuration + ' Ø³Ø§Ø¹Ø©',
                matchScore: t.matchScore
            })), null, 2);
        }
        
        // ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø³Ø§Ø­Ø©
        function optimizeSpace() {
            const trips = window.FastShipTripManager.getAllTrips();
            
            if (trips.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø­Ù„Ø§Øª Ù…ØªØ§Ø­Ø©');
                return;
            }
            
            const optimization = window.FastShip.optimizeTripSpace(trips[0].id);
            
            const output = document.getElementById('optimize-output');
            output.style.display = 'block';
            output.innerHTML = JSON.stringify({
                selectedShipments: optimization.shipments.length,
                totalWeight: optimization.totalWeight + ' ÙƒØ¬Ù…',
                utilization: optimization.utilization.toFixed(2) + '%',
                remainingCapacity: optimization.remainingCapacity + ' ÙƒØ¬Ù…'
            }, null, 2);
        }
    </script>
</body>
</html>
